@inject AppState AppState

<StackLayout>
    <StackLayout Orientation="StackOrientation.Horizontal">
        @* Input area *@
        <Entry @bind-Text="newText"
               Placeholder="What's to be done?"
               OnCompleted="@AddItem"
               IsEnabled="@(!isAdding)"
               HorizontalOptions="LayoutOptions.FillAndExpand" />
        <Button Text="Add"
                OnClick="@AddItem"
                IsEnabled="@(!isAdding)" />
        <ActivityIndicator Color="Color.Orange"
                           IsRunning="@isAdding" />
    </StackLayout>
    <ScrollView>
        <StackLayout>
            @* List of todos *@
            @foreach (var item in AppState.Items)
            {
                <TodoEntry Item="@item" />
            }
        </StackLayout>
    </ScrollView>
</StackLayout>

@code
{
    string newText;
    bool isAdding;

    async Task AddItem()
    {
        isAdding = true;
        StateHasChanged();

        // Pretend we're calling some API to save the new item
        await Task.Delay(2000);

        AppState.Items.Add(new TodoItem { Text = newText });
        newText = null;

        isAdding = false;
    }
}
